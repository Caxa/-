# ПОЯСНИТЕЛЬНАЯ ЗАПИСКА
## К курсовому проекту по дисциплине «Проектирование баз данных»

**Тема:** Система управления дискуссионным клубом

**Студент:** [ФИО]
**Группа:** [Номер группы]
**Руководитель:** [ФИО преподавателя]

---

## СОДЕРЖАНИЕ

1. [Титульный лист](#титульный-лист)
2. [Задание на курсовой проект](#задание)
3. [Введение](#введение)
4. [Краткие теоретические сведения](#теоретические-сведения)
5. [Описание выполнения задания](#выполнение-задания)
6. [Модель данных](#модель-данных)
7. [Результаты выполнения](#результаты)
8. [Выводы](#выводы)
9. [Приложения](#приложения)

---

## ТИТУЛЬНЫЙ ЛИСТ

> **ВАЖНО:** Титульный лист оформляется согласно требованиям вашего учебного заведения и ГОСТ 7.32-2017. Шаблон обычно предоставляется учебным заведением.

---

## ЗАДАНИЕ

> **ВАЖНО:** Здесь должны быть размещены листы заполненного задания по шаблону и вашего индивидуального варианта. Эти листы должны быть включены в общую нумерацию страниц документа.

---

## ВВЕДЕНИЕ

В рамках выполнения курсового проекта разработана информационная система для управления дискуссионным клубом. Система предназначена для автоматизации процессов организации турниров по дебатам, управления участниками, членами жюри, темами дебатов, проведения раундов и выступлений участников, а также для автоматизированного анализа результатов и формирования различных отчетов.

Актуальность разработки подобной системы обусловлена необходимостью повышения эффективности организации и проведения турниров по дебатам, автоматизации процессов оценки выступлений участников и анализа результатов.

**Цель курсового проекта:** разработать информационную систему управления дискуссионным клубом с использованием современных технологий проектирования баз данных и веб-приложений.

**Задачи проекта:**
- Спроектировать реляционную модель данных для предметной области дискуссионного клуба
- Нормализовать модель до требуемой нормальной формы
- Реализовать базу данных в СУБД PostgreSQL
- Разработать веб-приложение для работы с базой данных
- Реализовать аналитические запросы для обработки данных
- Внедрить механизмы обеспечения целостности данных (триггеры, функции, ограничения)

---

## ТЕОРЕТИЧЕСКИЕ СВЕДЕНИЯ

> **ВАЖНО:** В этом разделе необходимо добавить краткие теоретические сведения в соответствии с пунктами задания "Необходимо изучить", адаптированные к тематике вашего варианта.

### 2.1. Реляционная модель данных

Реляционная модель данных была предложена Эдгаром Коддом в 1970 году и является основой современных СУБД. В реляционной модели данные представляются в виде совокупности таблиц (отношений), связанных между собой через ключевые атрибуты [1].

**Основные понятия:**
- **Отношение (таблица)** — структура данных, состоящая из строк (кортежей) и столбцов (атрибутов)
- **Первичный ключ** — минимальный набор атрибутов, однозначно идентифицирующий каждый кортеж
- **Внешний ключ** — атрибут или набор атрибутов, ссылающихся на первичный ключ другой таблицы
- **Нормализация** — процесс организации данных для устранения избыточности и обеспечения целостности

### 2.2. Нормализация базы данных

Нормализация — процесс разделения данных на отдельные таблицы для устранения избыточности и аномалий. В курсовом проекте модель данных нормализована до **БКНФ (Бойса-Кодда нормальная форма)** [2].

**Преимущества нормализации:**
- Устранение избыточности данных
- Уменьшение размера базы данных
- Упрощение операций обновления
- Обеспечение целостности данных

### 2.3. Триггеры и хранимые процедуры

**Триггеры** — это специальные процедуры, автоматически выполняемые при наступлении определенных событий (INSERT, UPDATE, DELETE) в таблицах базы данных [3].

**Назначение триггеров:**
- Автоматизация бизнес-логики
- Обеспечение целостности данных
- Аудит изменений
- Валидация данных

В разработанной системе используются триггеры для:
- Автоматического обновления статуса турнира на основе текущей даты
- Валидации дат сезонов и турниров
- Логирования изменений данных участников
- Автоматической установки дат создания записей

### 2.4. Аналитические запросы (OLAP)

Аналитические запросы предназначены для извлечения и анализа больших объемов данных с целью получения полезной информации. В проекте реализованы запросы для:
- Подсчета итоговых результатов турниров
- Формирования рейтингов участников
- Статистического анализа по темам дебатов
- Агрегации данных по различным критериям

### 2.5. Веб-приложения на языке Go

Go (Golang) — компилируемый язык программирования, разработанный компанией Google. Отличается простотой синтаксиса, высокой производительностью и встроенной поддержкой конкурентности [4].

**Преимущества Go для веб-разработки:**
- Высокая производительность
- Простой синтаксис
- Встроенная поддержка многопоточности
- Статическая типизация
- Богатая стандартная библиотека

---

## ОПИСАНИЕ ВЫПОЛНЕНИЯ ЗАДАНИЯ

> **ВАЖНО:** В этом разделе необходимо детально описать выполнение каждого пункта задания "Необходимо самостоятельно выполнить".

### 3.1. Анализ предметной области

Предметной областью курсового проекта является дискуссионный клуб — организация, проводящая турниры по дебатам. 

**Основные сущности:**
- **Участники** — люди, участвующие в дебатах
- **Жюри** — эксперты, оценивающие выступления участников
- **Темы дебатов** — темы для обсуждения в раундах
- **Сезоны** — временные периоды проведения турниров
- **Турниры** — соревнования в рамках сезонов
- **Раунды** — отдельные этапы турнира по определенной теме
- **Выступления** — записи о выступлениях участников с оценками жюри

**Бизнес-правила:**
1. Участник может выступать в разных турнирах и раундах
2. Каждое выступление оценивается одним членом жюри по трем критериям: логика, риторика, эрудиция (по шкале от 1 до 10)
3. Участник в раунде занимает позицию "За" или "Против" по теме дебата
4. Турнир состоит из нескольких раундов
5. Раунд относится к одному турниру и одной теме
6. Турнир имеет статус: "предстоящий", "активный", "завершен" (автоматически определяется по датам)

### 3.2. Проектирование модели данных

Модель данных была спроектирована с использованием CASE-средства ERWin в соответствии с требованиями нормализации до БКНФ.

**Процесс проектирования:**
1. Выделение основных сущностей и их атрибутов
2. Определение связей между сущностями
3. Нормализация модели до БКНФ
4. Определение первичных и внешних ключей
5. Проектирование индексов для оптимизации запросов

### 3.3. Реализация базы данных

База данных реализована в СУБД PostgreSQL. Все объекты базы данных имеют русские названия в соответствии с требованиями проекта.

**Таблицы базы данных:**
- `участники` — информация об участниках турниров
- `жюри` — информация о членах жюри
- `темы` — темы дебатов
- `сезоны` — сезоны проведения турниров
- `турниры` — турниры в рамках сезонов
- `раунды` — раунды турниров
- `выступления` — записи о выступлениях участников с оценками
- `участники_audit` — журнал изменений участников (для аудита)

### 3.4. Реализация функций и триггеров

**Функции базы данных:**
- `расчет_итогового_балла(логика, риторика, эрудиция)` — функция для расчета итогового балла выступления как суммы трех оценок
- `обновить_все_статусы_турниров()` — функция для автоматического обновления статусов всех турниров на основе текущей даты

**Триггеры:**
- Триггеры валидации данных (даты сезонов, даты турниров)
- Триггеры аудита (логирование изменений участников)
- Триггеры автоматического обновления статусов
- Триггеры автоматической установки дат создания

### 3.5. Разработка веб-приложения

Веб-приложение разработано на языке Go с использованием стандартной библиотеки `html/template` для генерации HTML и `database/sql` для работы с базой данных.

**Архитектура приложения:**
- **Слой моделей** (`internal/models`) — структуры данных Go, соответствующие таблицам БД
- **Слой репозитория** (`internal/repository`) — методы доступа к данным, содержащие SQL-запросы
- **Слой обработчиков** (`internal/handlers`) — HTTP-обработчики для обработки запросов
- **Слой представления** (`templates`) — HTML-шаблоны для отображения данных

**Реализованный функционал:**
- CRUD-операции для всех основных сущностей (создание, чтение, обновление, удаление)
- Поиск и фильтрация данных
- Аналитические запросы с выводом результатов через веб-интерфейс
- Редактирование оценок выступлений жюри

### 3.6. Реализация аналитических запросов

Реализовано 8 аналитических запросов (запросы а-з согласно заданию):

**а) Список всех участников турнира с указанием их команды по каждой теме**
```sql
SELECT DISTINCT
    у.ид as participant_id,
    у.имя as first_name,
    у.фамилия as last_name,
    т.ид as topic_id,
    т.заголовок as topic_title,
    в.позиция as position
FROM участники у
JOIN выступления в ON у.ид = в.ид_участника
JOIN раунды р ON в.ид_раунда = р.ид
JOIN темы т ON р.ид_темы = т.ид
WHERE р.ид_турнира = $1
ORDER BY т.ид, у.ид
```

**б) Итоговые результаты турнира** (с ранжированием по местам)
```sql
SELECT 
    у.ид as participant_id,
    у.имя as first_name,
    у.фамилия as last_name,
    COALESCE(SUM(расчет_итогового_балла(в.оценка_логики, в.оценка_риторики, в.оценка_эрудиции)), 0) as total_score
FROM участники у
JOIN выступления в ON у.ид = в.ид_участника
JOIN раунды р ON в.ид_раунда = р.ид
WHERE р.ид_турнира = $1
GROUP BY у.ид, у.имя, у.фамилия
ORDER BY total_score DESC
```

**в) Статистика побед "За" и "Против" по каждой теме** (с использованием оконных функций)
```sql
WITH round_scores AS (
    SELECT 
        р.ид_темы,
        р.ид as round_id,
        в.позиция,
        SUM(COALESCE(в.оценка_логики, 0) + COALESCE(в.оценка_риторики, 0) + COALESCE(в.оценка_эрудиции, 0)) as team_score
    FROM выступления в
    JOIN раунды р ON в.ид_раунда = р.ид
    WHERE в.оценка_логики IS NOT NULL 
      AND в.оценка_риторики IS NOT NULL 
      AND в.оценка_эрудиции IS NOT NULL
    GROUP BY р.ид_темы, р.ид, в.позиция
),
round_winners AS (
    SELECT 
        ид_темы,
        round_id,
        позиция,
        team_score,
        MAX(team_score) OVER (PARTITION BY ид_темы, round_id) as max_score
    FROM round_scores
),
winners_only AS (
    SELECT 
        ид_темы,
        round_id,
        позиция,
        team_score
    FROM round_winners
    WHERE team_score = max_score
),
wins_by_position AS (
    SELECT 
        ид_темы,
        COUNT(DISTINCT CASE WHEN позиция = 'За' THEN round_id END) as for_wins,
        COUNT(DISTINCT CASE WHEN позиция = 'Против' THEN round_id END) as against_wins
    FROM winners_only
    GROUP BY ид_темы
)
SELECT 
    т.ид as topic_id,
    т.заголовок as topic_title,
    COALESCE(w.for_wins, 0) as for_wins,
    COALESCE(w.against_wins, 0) as against_wins
FROM темы т
LEFT JOIN wins_by_position w ON т.ид = w.ид_темы
ORDER BY т.ид
```

**г) Рейтинг участников по сумме баллов за все турниры текущего сезона**
```sql
SELECT 
    у.ид as participant_id,
    у.имя as first_name,
    у.фамилия as last_name,
    COALESCE(SUM(расчет_итогового_балла(в.оценка_логики, в.оценка_риторики, в.оценка_эрудиции)), 0) as total_score
FROM участники у
INNER JOIN выступления в ON у.ид = в.ид_участника
INNER JOIN раунды р ON в.ид_раунда = р.ид
INNER JOIN турниры т ON р.ид_турнира = т.ид
WHERE т.ид_сезона = $1
GROUP BY у.ид, у.имя, у.фамилия
ORDER BY total_score DESC
```

**д) Средняя оценка каждого участника по каждому критерию**
```sql
SELECT 
    у.ид as participant_id,
    у.имя as first_name,
    у.фамилия as last_name,
    ROUND(AVG(в.оценка_логики)::numeric, 2) as avg_logic,
    ROUND(AVG(в.оценка_риторики)::numeric, 2) as avg_rhetoric,
    ROUND(AVG(в.оценка_эрудиции)::numeric, 2) as avg_erudition
FROM участники у
LEFT JOIN выступления в ON у.ид = в.ид_участника
WHERE в.оценка_логики IS NOT NULL 
  AND в.оценка_риторики IS NOT NULL 
  AND в.оценка_эрудиции IS NOT NULL
GROUP BY у.ид, у.имя, у.фамилия
ORDER BY у.ид
```

**е) Список членов жюри, участвовавших в наибольшем количестве турниров**
```sql
SELECT 
    ж.ид as judge_id,
    ж.имя as first_name,
    ж.фамилия as last_name,
    COUNT(DISTINCT р.ид_турнира) as count
FROM жюри ж
JOIN выступления в ON ж.ид = в.ид_судьи
JOIN раунды р ON в.ид_раунда = р.ид
GROUP BY ж.ид, ж.имя, ж.фамилия
ORDER BY count DESC
```

**ж) Список тем, использованных более одного раза за сезон**
```sql
SELECT 
    т.ид as topic_id,
    т.заголовок as topic_title,
    COUNT(DISTINCT р.ид_турнира) as usage_count
FROM темы т
JOIN раунды р ON т.ид = р.ид_темы
JOIN турниры тур ON р.ид_турнира = тур.ид
WHERE тур.ид_сезона = $1
GROUP BY т.ид, т.заголовок
HAVING COUNT(DISTINCT р.ид_турнира) > 1
ORDER BY usage_count DESC
```

**з) Расписание турнира с указанием тем и участников**
```sql
SELECT 
    р.номер_раунда,
    р.дата_раунда,
    т.заголовок as topic_title,
    STRING_AGG(
        у.имя || ' ' || у.фамилия || ' (' || в.позиция || ')',
        ', '
        ORDER BY в.позиция, у.фамилия
    ) as participants
FROM раунды р
JOIN темы т ON р.ид_темы = т.ид
LEFT JOIN выступления в ON р.ид = в.ид_раунда
LEFT JOIN участники у ON в.ид_участника = у.ид
WHERE р.ид_турнира = $1
GROUP BY р.номер_раунда, р.дата_раунда, т.заголовок
ORDER BY р.номер_раунда
```

### 3.7. Реализация пользовательского интерфейса

Пользовательский интерфейс реализован с использованием HTML-шаблонов и CSS. Интерфейс выполнен в современном стиле с использованием градиентов и адаптивной верстки.

**Основные страницы:**
- Главная страница (дашборд) с общей статистикой
- Управление участниками
- Управление жюри
- Управление темами дебатов
- Управление сезонами и турнирами
- Управление раундами
- Управление выступлениями
- Страница аналитических запросов

**Функциональность интерфейса:**
- Создание, просмотр, редактирование и удаление записей
- Поиск и фильтрация данных
- Вывод результатов аналитических запросов
- Формы ввода с валидацией данных

---

## МОДЕЛЬ ДАННЫХ

### 4.1. ER-диаграмма

> **ВАЖНО:** Здесь должна быть размещена ER-диаграмма, созданная в ERWin, с описанием всех сущностей, атрибутов и связей.

### 4.2. Описание принятых решений по проектированию

**Нормализация:**
Модель данных нормализована до БКНФ (Бойса-Кодда нормальной формы). Все зависимости функциональные, каждый детерминант является потенциальным ключом.

**Обоснование структуры таблиц:**

1. **Таблица `участники`**
   - Первичный ключ: `ид` (автоинкремент)
   - Уникальное ограничение на `электронная_почта` (один email — один участник)
   - Обоснование: Выделение в отдельную таблицу позволяет избежать дублирования данных об участниках

2. **Таблица `жюри`**
   - Первичный ключ: `ид`
   - Уникальное ограничение на `электронная_почта`
   - Обоснование: Члены жюри — отдельная сущность с собственными характеристиками

3. **Таблица `темы`**
   - Первичный ключ: `ид`
   - Обоснование: Темы дебатов могут использоваться в разных турнирах, поэтому выделены в отдельную таблицу

4. **Таблица `сезоны`**
   - Первичный ключ: `ид`
   - Проверка: `дата_окончания >= дата_начала`
   - Обоснование: Сезоны объединяют несколько турниров, имеют временные рамки

5. **Таблица `турниры`**
   - Первичный ключ: `ид`
   - Внешний ключ: `ид_сезона` → `сезоны.ид`
   - Статус определяется автоматически триггерами на основе дат
   - Обоснование: Турниры проводятся в рамках сезонов

6. **Таблица `раунды`**
   - Первичный ключ: `ид`
   - Внешние ключи: `ид_турнира` → `турниры.ид`, `ид_темы` → `темы.ид`
   - Уникальное ограничение: `(ид_турнира, номер_раунда)` — в одном турнире не может быть двух раундов с одинаковым номером
   - Обоснование: Раунд принадлежит одному турниру и одной теме

7. **Таблица `выступления`**
   - Первичный ключ: `ид`
   - Внешние ключи: `ид_раунда` → `раунды.ид`, `ид_участника` → `участники.ид`, `ид_судьи` → `жюри.ид`
   - Поля оценок: `оценка_логики`, `оценка_риторики`, `оценка_эрудиции` (INTEGER, NULL допустим)
   - Проверка: оценки в диапазоне 1-10 (через триггеры)
   - Обоснование: Выступление связывает участника, раунд, жюри и содержит оценки

8. **Таблица `участники_audit`**
   - Первичный ключ: `ид`
   - Внешний ключ: `участник_ид` → `участники.ид` ON DELETE CASCADE
   - Обоснование: Таблица аудита для отслеживания изменений (создается и заполняется триггерами)

**Индексы:**
- Индексы на всех первичных и внешних ключах (создаются автоматически)
- Индекс на `электронная_почта` в таблицах `участники` и `жюри` (для быстрого поиска)
- Индекс на `дата_создания` в основных таблицах (для сортировки по дате)

**Ограничения целостности:**
- Внешние ключи с каскадным удалением где необходимо
- Проверочные ограничения (CHECK) на диапазоны значений
- Уникальные ограничения на email адреса
- Уникальные ограничения на пары (турнир, номер_раунда)

---

## РЕЗУЛЬТАТЫ ВЫПОЛНЕНИЯ

> **ВАЖНО:** В этом разделе должны быть размещены снимки экрана или фрагменты снимков с изображением результата выполнения по каждому пункту задания. Масштаб изображения должен быть хорошо виден при масштабе страницы 100%.

### 5.1. Снимки экрана работы с базой данных

[Здесь должны быть размещены снимки экрана:]

- ER-диаграмма из ERWin
- Структура таблиц в PostgreSQL (pgAdmin или psql)
- Примеры данных в таблицах
- Результаты выполнения аналитических запросов
- Работа триггеров (до и после срабатывания)
- Работа функций базы данных

### 5.2. Снимки экрана работы веб-приложения

[Здесь должны быть размещены снимки экрана:]

- Главная страница (дашборд)
- Страница управления участниками
- Страница управления жюри
- Страница управления темами
- Страница управления сезонами
- Страница управления турнирами
- Страница управления раундами
- Страница управления выступлениями
- Страница аналитических запросов с результатами
- Формы создания/редактирования записей
- Результаты поиска и фильтрации

---

## ВЫВОДЫ

В ходе выполнения курсового проекта была разработана полнофункциональная информационная система для управления дискуссионным клубом.

**Достигнутые результаты:**
1. ✅ Спроектирована нормализованная модель данных до БКНФ
2. ✅ Реализована база данных в СУБД PostgreSQL с использованием триггеров и функций
3. ✅ Разработано веб-приложение на языке Go с пользовательским интерфейсом
4. ✅ Реализованы все требуемые аналитические запросы
5. ✅ Обеспечена целостность данных через ограничения и триггеры
6. ✅ Все операции доступны через веб-интерфейс без прямого доступа к СУБД

**Выводы:**
- Модель данных успешно нормализована, что исключает избыточность и аномалии обновления
- Использование триггеров обеспечивает автоматизацию бизнес-логики и валидацию данных на уровне БД
- Веб-приложение предоставляет удобный интерфейс для всех операций с данными
- Аналитические запросы позволяют эффективно извлекать и анализировать информацию о турнирах, участниках и результатах

**Возможности для дальнейшего развития:**
- Добавление системы аутентификации и авторизации пользователей
- Реализация экспорта отчетов в различных форматах (PDF, Excel)
- Добавление графиков и диаграмм для визуализации статистики
- Реализация мобильной версии приложения
- Добавление системы уведомлений участникам и жюри

---

## ИСПОЛЬЗОВАНИЕ ИИ В РАЗРАБОТКЕ

> **ВАЖНО:** Согласно рекомендациям, необходимо указать, где и как использовался ИИ.

**Использование ИИ при разработке:**
- ✅ ИИ использовался для разработки веб-приложения (генерация Go-кода, HTML-шаблонов)
- ✅ ИИ использовался для генерации тестовых данных
- ✅ ИИ использовался для анализа и исправления ошибок в коде
- ❌ ИИ **НЕ** использовался для генерации SQL-запросов и проектирования базы данных

**Используемые промпты и модели:**
- Модель: [Указать версию/название ИИ, если известна, например: GPT-4, Claude и т.д.]
- Промпты использовались для:
  - Генерации структуры Go-приложения
  - Создания HTML-шаблонов и CSS-стилей
  - Решения технических проблем и отладки кода
  - Генерации тестовых данных для заполнения базы

---

## СПИСОК ИСПОЛЬЗОВАННЫХ ИСТОЧНИКОВ

1. Кодд, Э. Ф. Реляционная модель данных для больших совместно используемых банков данных / Э. Ф. Кодд // Коммуникации ACM. — 1970. — Т. 13, № 6. — С. 377–387.

2. Коннолли, Т. Базы данных: проектирование, реализация и сопровождение. Теория и практика / Т. Коннолли, К. Бегг ; пер. с англ. — 3-е изд. — М. : Вильямс, 2003. — 1440 с.

3. PostgreSQL: Документация [Электронный ресурс]. — Режим доступа: https://www.postgresql.org/docs/ (дата обращения: [дата]).

4. Go Documentation [Электронный ресурс]. — Режим доступа: https://go.dev/doc/ (дата обращения: [дата]).

5. ГОСТ 7.32-2017. Система стандартов по информации, библиотечному и издательскому делу. Отчет о научно-исследовательской работе. Структура и правила оформления. — М. : Стандартинформ, 2017. — 22 с.

---

## ПРИЛОЖЕНИЯ

### Приложение А. Полный код разработанного ПО

#### А.1. Схема базы данных (SQL)

```sql
-- Здесь должен быть полный SQL-код создания всех таблиц, 
-- индексов, ограничений, функций и триггеров
```

> **ВАЖНО:** Вставьте здесь полный код SQL из файлов schema.sql, triggers.sql и других SQL-файлов проекта.

#### А.2. Код веб-приложения (Go)

> **ВАЖНО:** Вставьте здесь полный код всех Go-файлов проекта:
> - main.go
> - internal/models/models.go
> - internal/database/db.go
> - internal/repository/repository.go
> - internal/handlers/handlers.go

#### А.3. HTML-шаблоны

> **ВАЖНО:** Вставьте здесь код всех HTML-шаблонов из папки templates/

#### А.4. Тестовые данные (seed.sql)

```sql
-- Здесь должен быть SQL-код для заполнения базы тестовыми данными
```

### Приложение Б. Результаты выполнения аналитических запросов

> **ВАЖНО:** Здесь должны быть размещены примеры результатов выполнения всех аналитических запросов (запросы а-з) в виде таблиц или снимков экрана.

---

**Подпись студента:** ________________ [ФИО]

**Дата:** "___" __________ 2026 г.

