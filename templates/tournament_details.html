{{template "base.html" .}}
{{define "title"}}Детали турнира - Дискуссионный клуб{{end}}

{{define "content"}}
<h2>Детали турнира</h2>

{{if .Tournament}}
<div style="background: linear-gradient(135deg, rgba(102, 126, 234, 0.05) 0%, rgba(118, 75, 162, 0.05) 100%); border: 2px solid rgba(102, 126, 234, 0.2); border-radius: 12px; padding: 25px; margin: 20px 0;">
    <h3>Информация о турнире</h3>
    <p><strong>Название:</strong> {{.Tournament.Name}}</p>
    <p><strong>Дата начала:</strong> {{.Tournament.StartDate.Format "02.01.2006"}}</p>
    <p><strong>Дата окончания:</strong> {{if .Tournament.EndDate}}{{.Tournament.EndDate.Format "02.01.2006"}}{{else}}-{{end}}</p>
    <p><strong>Статус:</strong> 
        <span class="status-badge 
            {{if and .Tournament.Status (eq .Tournament.Status.Code "active")}}status-active
            {{else if and .Tournament.Status (eq .Tournament.Status.Code "completed")}}status-completed
            {{else}}status-upcoming{{end}}">
            {{if .Tournament.Status}}{{.Tournament.Status.Name}}{{else}}Предстоящий{{end}}
        </span>
    </p>
</div>

{{if .Rounds}}
{{$count := len .Rounds}}
{{if gt $count 0}}
<h3>Раунды турнира</h3>
<table>
    <thead>
        <tr>
            <th>Номер раунда</th>
            <th>Дата</th>
            <th>Тема</th>
            <th>Действия</th>
        </tr>
    </thead>
    <tbody>
        {{range .Rounds}}
        <tr>
            <td><strong>{{.RoundNumber}}</strong></td>
            <td>{{.RoundDate.Format "02.01.2006"}}</td>
            <td>
                {{if $.Topics}}
                    {{$topic := index $.Topics .TopicID}}
                    {{if $topic}}
                        <strong>{{$topic.Title}}</strong>
                        {{if $topic.Description}}
                            <br><small style="color: #666;">{{$topic.Description}}</small>
                        {{end}}
                    {{else}}
                        Тема не найдена
                    {{end}}
                {{else}}
                    Тема не найдена
                {{end}}
            </td>
            <td>
                <a href="/rounds/details?id={{.ID}}" class="btn">Подробнее</a>
            </td>
        </tr>
        {{end}}
    </tbody>
</table>
{{else}}
<div class="empty-state">
    <p>В этом турнире пока нет раундов.</p>
</div>
{{end}}
{{else}}
<div class="empty-state">
    <p>В этом турнире пока нет раундов.</p>
</div>
{{end}}

<a href="/tournaments" class="btn">← Назад к списку турниров</a>
{{else}}
<div class="empty-state">
    <p>Турнир не найден.</p>
</div>
<a href="/tournaments" class="btn">← Назад к списку турниров</a>
{{end}}
{{end}}
